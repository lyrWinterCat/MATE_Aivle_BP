<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì •ì •ê²Œì‹œíŒ</title>
    <link rel="stylesheet" type="text/css" href="/css/boardDetail.css" />
    <link rel="stylesheet" type="text/css" href="/css/header.css"/>
    <link rel="stylesheet" type="text/css" href="/css/boardfunction.css" />
</head>
<body>
<header>
    <div class="header-left">
        <a href="/admin/adminMain">
            <img src="/img/logo.png" alt="Mate Logo" class="logo-img">
        </a>
        <h1>Mate</h1>
    </div>
    <div class="header-right">
        <form action="/admin/adminMain" method="get" style="display:inline;">
            <button type="submit" class="nav-button">í†µê³„</button>
        </form>
        <button>ë¡œê·¸ì¡°íšŒ</button>
        <form action="/signOut" method="post" style="display:inline;">
            <button type="submit" class="nav-button">ë¡œê·¸ì•„ì›ƒ</button>
        </form>
    </div>
</header>

<div class="subtitle-container">
    <h2>ì •ì • ê²Œì‹œê¸€ ìŠ¹ì¸/ë°˜ë ¤</h2>
</div>

<div class="container">
    <form action="../adminFix/detail" method="post">
        <input type="hidden" id="feedbackId" name="feedbackId">
        <div class="read-group">
            <label for="title">ì œëª©</label>
            <input type="text" id="title" value="{{title}}" readonly>
        </div>

        <div class="read-group">
            <label for="user-info">ì‚¬ì›ì •ë³´</label>
            <input type="text" id="user-info" value="{{userName}}" readonly>
        </div>
        <div class="read-group">
            <label for="reference">ë…ì„±ë°œì–¸ì¡°íšŒ</label>
            <input type="text" id="reference" value="{{speechLogTimestamp}} / {{toxicityId}}" readonly>
        </div>
        <div class="read-file-upload">
            <label for="filepath_read">ì²¨ë¶€ íŒŒì¼</label>
            {{#filepath}}
            <!-- Controllerê°€ ì•„ë‹ˆë¼ WebConfigì˜ ì •ì  ë¦¬ì†ŒìŠ¤ ë§¤í•‘(registry.addResourceHandler)ì„ í†µí•´ '/file/**' ê²½ë¡œë¡œ íŒŒì¼ì„ ì§ì ‘ ì œê³µí•¨ -->
            <a href="/file/{{filepath}}" target="_blank" id="filepath_read" class="file-download">ğŸ“‚ ë‹¤ìš´ë¡œë“œ</a>
            {{/filepath}}
            {{^filepath}}
            <input type="text" value="ì—…ë¡œë“œëœ ì²¨ë¶€íŒŒì¼ì´ ì—†ìŒ" readonly>
            {{/filepath}}
        </div>
        <div class="read-group">
            <label for="content">ë‚´ìš©</label>
            <textarea id="content" rows="8" readonly>{{content}}</textarea>
        </div>
        <div class="read-group">
            <label for="response">ë‹µë³€</label>
            <textarea id="response" name="response" rows="8" placeholder="ë‹µë³€ì„ ì…ë ¥í•˜ì„¸ìš”">{{response}}</textarea>
        </div>
        <div class="read-group">
            <label>ìƒíƒœ</label>
            <div class="status-options">
                <input type="radio" id="approved" name="status" value="ìŠ¹ì¸">
                <label for="approved" class="status-label approved">ìŠ¹ì¸</label>

                <input type="radio" id="rejected" name="status" value="ë°˜ë ¤">
                <label for="rejected" class="status-label rejected">ë°˜ë ¤</label>
            </div>
        </div>
        <div class="btnArea">
            <button id="submitBtn" type="submit" class="submit-btn">ë‹µë³€í•˜ê¸°</button>
            <button id="backBtn" onclick="goback()" type="button" class="submit-btn">ë’¤ë¡œê°€ê¸°</button>
        </div>
    </form>

</div>
</body>
<script>
    document.addEventListener("DOMContentLoaded", function() {

        //filepathë¹ˆê°’ì¼ ì‹œ ëŒ€ì²´ë¬¸êµ¬
        const filepath = document.getElementById("attachment");
        if (filepath) {
            if (filepath.value.trim() === "") {
                filepath.value = "ì—…ë¡œë“œëœ ì²¨ë¶€íŒŒì¼ì´ ì—†ìŒ";
            }
        }

        //feedbackId ì„¸íŒ…
        const urlParams = new URLSearchParams(window.location.search);
        const feedbackId = urlParams.get("feedbackId");
        if(feedbackId){
            document.getElementById("feedbackId").value = feedbackId;
        }

        //{{status}}ê°’ì´ ìˆì„ ë•Œ ë¼ë””ì˜¤ë²„íŠ¼ ì„ íƒ
        const statusValue = "{{status}}";
        console.log(statusValue);
        if(statusValue.trim() === "ìŠ¹ì¸"){
            document.getElementById("approved").checked = true;
            document.getElementById("submitBtn").style.display="none";
        }else if(statusValue.trim() === "ë°˜ë ¤"){
            document.getElementById("rejected").checked = true;
            document.getElementById("submitBtn").style.display="none";
        }
    });

    function goback(){
        if (confirm("ì •ì •ê²Œì‹œê¸€ ë¦¬ìŠ¤íŠ¸ë¡œ ë˜ëŒì•„ê°€ì‹œê² ìŠµë‹ˆê¹Œ?")) {
            window.location.href = "/admin/adminFix";
        }
    }
</script>
</html>
